<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Authentication - WildFly 9</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8" />
    <meta content="Scroll Wiki Publisher" name="generator"/>

    <link type="text/css" rel="stylesheet" href="css/blueprint/liquid.css" media="screen, projection"/>
    <link type="text/css" rel="stylesheet" href="css/blueprint/print.css" media="print"/>
    <!--[if lt IE 8]><link rel="stylesheet" href="css/blueprint/ie.css" type="text/css" media="screen, projection"/><![endif]-->

    <link type="text/css" rel="stylesheet" href="css/content-style.css" media="screen, projection, print"/>
    <link type="text/css" rel="stylesheet" href="css/screen.css" media="screen, projection"/>
    <link type="text/css" rel="stylesheet" href="css/print.css" media="print"/>
    
    <link type="text/css" rel="stylesheet" href="css/jbossorg.css"/>
    <link type="text/css" rel="stylesheet" href="css/docnav.css"/>    
    
    <link type="text/css" rel="stylesheet" href="sh/shCore.css"/>
    <link type="text/css" rel="stylesheet" href="sh/shCoreDefault.css"/>
    <script type="text/javascript" src="sh/shCore.js"></script>
    <script type="text/javascript" src="sh/shBrushAppleScript.js"></script>
    <script type="text/javascript" src="sh/shBrushAS3.js"></script>
    <script type="text/javascript" src="sh/shBrushBash.js"></script>
    <script type="text/javascript" src="sh/shBrushCpp.js"></script>
    <script type="text/javascript" src="sh/shBrushCSharp.js"></script>
    <script type="text/javascript" src="sh/shBrushCss.js"></script>
    <script type="text/javascript" src="sh/shBrushDiff.js"></script>
    <script type="text/javascript" src="sh/shBrushErlang.js"></script>
    <script type="text/javascript" src="sh/shBrushGroovy.js"></script>
    <script type="text/javascript" src="sh/shBrushJava.js"></script>
    <script type="text/javascript" src="sh/shBrushJavaFX.js"></script>
    <script type="text/javascript" src="sh/shBrushJScript.js"></script>
    <script type="text/javascript" src="sh/shBrushPerl.js"></script>
    <script type="text/javascript" src="sh/shBrushPhp.js"></script>
    <script type="text/javascript" src="sh/shBrushPlain.js"></script>
    <script type="text/javascript" src="sh/shBrushPython.js"></script>
    <script type="text/javascript" src="sh/shBrushRuby.js"></script>
    <script type="text/javascript" src="sh/shBrushScala.js"></script>
    <script type="text/javascript" src="sh/shBrushSql.js"></script>
    <script type="text/javascript" src="sh/shBrushVb.js"></script>
    <script type="text/javascript" src="sh/shBrushXml.js"></script>
    
</head>
<body>
    <div class="container" style="min-width: 760px;">
        <div class="block header">
          <p id="title">
            <a class="site_href" href="http://www.jboss.org"><strong>JBoss.org</strong></a>
            <a class="doc_href" href="http://docs.jboss.org"><strong>Community Documentation</strong></a>
          </p>
                  <ul class="docnav">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <li class="previous"><a accesskey="p" href="Predefined_client_and_endpoint_configurations.html"><strong>Prev</strong></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <li class="next"><a accesskey="n" href="Apache_CXF_integration.html"><strong>Next</strong></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </ul>
                    <div>
            <h1>Authentication</h1>
          </div>          
          </div>

        <div class="block content">
<ul class=" "><li class=" ">    <p>
<a href="Authentication.html#80873265_Authentication-Authentication">Authentication</a>    </p>
<ul class=" "><li class=" ">    <p>
<a href="Authentication.html#80873265_Authentication-Specifythesecuritydomain">Specify the security domain</a>    </p>
</li><li class=" ">    <p>
<a href="Authentication.html#80873265_Authentication-UseBindingProvidertosetprincipal%2Fcredential">Use BindingProvider to set principal/credential</a>    </p>
</li><li class=" ">    <p>
<a href="Authentication.html#80873265_Authentication-UsingHTTPBasicAuthforsecurity">Using HTTP Basic Auth for security</a>    </p>
</li></ul></li><li class=" ">    <p>
<a href="Authentication.html#80873265_Authentication-JASPIAuthentication">JASPI Authentication</a>    </p>
</li></ul>    <div class="section-2"  id="80873265_Authentication-Authentication"  >
        <h2>Authentication</h2>
    
    <p>
Here the simplest way to authenticate a web service user with JBossWS is explained.    </p>
    <p>
First  we secure the access to the SLSB as we would do for normal (non web  service) invocations: this can be easily done through the @RolesAllowed,  @PermitAll, @DenyAll annotation. The allowed user roles can be set with  these annotations both on the bean class and on any of its business  methods.    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">@Stateless
@RolesAllowed(&quot;friend&quot;)
public class EndpointEJB implements EndpointInterface
{
  ...
}</pre>
        </div>
    </div>
    <p>
Similarly POJO endpoints are secured the same way as we do for normal web applications in web.xml:    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: xml; gutter: false;">&lt;security-constraint&gt;
  &lt;web-resource-collection&gt;
    &lt;web-resource-name&gt;All resources&lt;/web-resource-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;/web-resource-collection&gt;
  &lt;auth-constraint&gt;
    &lt;role-name&gt;friend&lt;/role-name&gt;
  &lt;/auth-constraint&gt;
&lt;/security-constraint&gt;

&lt;security-role&gt;
  &lt;role-name&gt;friend&lt;/role-name&gt;
&lt;/security-role&gt;</pre>
        </div>
    </div>
    <div class="section-3"  id="80873265_Authentication-Specifythesecuritydomain"  >
        <h3>Specify the security domain</h3>
    
    <p>
Next, specify the security domain for this deployment. This is performed using the <tt class=" ">@SecurityDomain</tt> annotation for EJB3 endpoints    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">@Stateless
@SecurityDomain(&quot;JBossWS&quot;)
@RolesAllowed(&quot;friend&quot;)
public class EndpointEJB implements EndpointInterface
{
  ...
}</pre>
        </div>
    </div>
    <p>
or modifying the jboss-web.xml for POJO endpoints    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: xml; gutter: false;">&lt;jboss-web&gt;
&lt;security-domain&gt;JBossWS&lt;/security-domain&gt;
&lt;/jboss-web&gt;</pre>
        </div>
    </div>
    <p>
The security domain as well as its the authentication and authorization mechanisms are defined differently depending on the application server version in use.    </p>
    </div>
    
    <div class="section-3"  id="80873265_Authentication-UseBindingProvidertosetprincipal%2Fcredential"  >
        <h3>Use BindingProvider to set principal/credential</h3>
    
    <p>
A web service client may use the <tt class=" ">javax.xml.ws.BindingProvider</tt> interface to set the username/password combination    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">URL wsdlURL = new File(&quot;resources/jaxws/samples/context/WEB-INF/wsdl/TestEndpoint.wsdl&quot;).toURL();
QName qname = new QName(&quot;http://org.jboss.ws/jaxws/context&quot;, &quot;TestEndpointService&quot;);
Service service = Service.create(wsdlURL, qname);
port = (TestEndpoint)service.getPort(TestEndpoint.class);

BindingProvider bp = (BindingProvider)port;
bp.getRequestContext().put(BindingProvider.USERNAME_PROPERTY, &quot;kermit&quot;);
bp.getRequestContext().put(BindingProvider.PASSWORD_PROPERTY, &quot;thefrog&quot;);</pre>
        </div>
    </div>
    </div>
    
    <div class="section-3"  id="80873265_Authentication-UsingHTTPBasicAuthforsecurity"  >
        <h3>Using HTTP Basic Auth for security</h3>
    
    <p>
To enable HTTP Basic authentication you use the <tt class=" ">@WebContext</tt> annotation on the bean class    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">@Stateless
@SecurityDomain(&quot;JBossWS&quot;)
@RolesAllowed(&quot;friend&quot;)
@WebContext(contextRoot=&quot;/my-cxt&quot;, urlPattern=&quot;/*&quot;, authMethod=&quot;BASIC&quot;, transportGuarantee=&quot;NONE&quot;, secureWSDLAccess=false)
public class EndpointEJB implements EndpointInterface
{
  ...
}</pre>
        </div>
    </div>
    <p>
For POJO endpoints, we modify the <i class=" ">web.xml</i> adding the auth-method element:    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: xml; gutter: false;">&lt;login-config&gt;
  &lt;auth-method&gt;BASIC&lt;/auth-method&gt;
  &lt;realm-name&gt;Test Realm&lt;/realm-name&gt;
&lt;/login-config&gt;</pre>
        </div>
    </div>
    </div>
    
    </div>
    
    <div class="section-2"  id="80873265_Authentication-JASPIAuthentication"  >
        <h2>JASPI Authentication</h2>
    
    <p>
A Java Authentication SPI (JASPI) provider can be configured in WildFly security subsystem to authenticate SOAP messages:    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: xml; gutter: false;">&lt;security-domain name=&quot;jaspi&quot;&gt;
&lt;authentication-jaspi&gt;
&lt;login-module-stack name=&quot;jaas-lm-stack&quot;&gt;
&lt;login-module code=&quot;UsersRoles&quot; flag=&quot;required&quot;&gt;
&lt;module-option name=&quot;usersProperties&quot; value=&quot;jbossws-users.properties&quot;/&gt;
&lt;module-option name=&quot;rolesProperties&quot; value=&quot;jbossws-roles.properties&quot;/&gt;
&lt;/login-module&gt;
&lt;/login-module-stack&gt;
&lt;auth-module code=&quot;org.jboss.wsf.stack.cxf.jaspi.module.UsernameTokenServerAuthModule&quot; login-module-stack-ref=&quot;jaas-lm-stack&quot;/&gt;
&lt;/authentication-jaspi&gt;
&lt;/security-domain&gt;</pre>
        </div>
    </div>
    <div class="confbox admonition admonition-info">
        
    <p>
For further information on configuring security domains in WildFly, please refer to <a href="https://docs.jboss.org/author/display/WFLY9/Security+subsystem+configuration">here</a>.    </p>
    </div>
    
    <p>
Here <tt class=" ">org.jboss.wsf.stack.cxf.jaspi.module.UsernameTokenServerAuthModule</tt> is the class implementing <tt class=" ">javax.security.auth.message.module.ServerAuthModule</tt>,&nbsp; which delegates to the proper login module to perform authentication using the credentials from WS-Security UsernameToken in the incoming SOAP message. Alternative implementations of <tt class=" ">ServerAuthModule</tt> can be implemented and configured.    </p>
    <p>
To enable JASPI authentication, the endpoint deployment needs to specify the security domain to use; that can be done in two different ways:    </p>
<ul class=" "><li class=" ">    <p>
Setting the <tt class=" ">jaspi.security.domain</tt> property in the <tt class=" ">jboss-webservices.xml</tt> descriptor    </p>
</li></ul>    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: xml; gutter: false;">&lt;?xml version=&quot;1.1&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;webservices
xmlns=&quot;http://www.jboss.com/xml/ns/javaee&quot;
xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
version=&quot;1.2&quot;
xsi:schemaLocation=&quot;http://www.jboss.com/xml/ns/javaee&quot;&gt;

&lt;property&gt;
&lt;name&gt;jaspi.security.domain&lt;/name&gt;
&lt;value&gt;jaspi&lt;/value&gt;
&lt;/property&gt;

&lt;/webservices&gt;</pre>
        </div>
    </div>
<ul class=" "><li class=" ">    <p>
Referencing (through <tt class=" ">@EndpointConfig</tt> annotation) an endpoint config that sets the <tt class=" ">jaspi.security.domain</tt> property    </p>
</li></ul>    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">@EndpointConfig(configFile = &quot;WEB-INF/jaxws-endpoint-config.xml&quot;, configName = &quot;jaspiSecurityDomain&quot;)
public class ServiceEndpointImpl implements ServiceIface {</pre>
        </div>
    </div>
    <p>
The <tt class=" ">jaspi.security.domain</tt> property is specified as follows in the referenced descriptor:    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: xml; gutter: false;">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;jaxws-config xmlns=&quot;urn:jboss:jbossws-jaxws-config:4.0&quot;
xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:javaee=&quot;http://java.sun.com/xml/ns/javaee&quot;
xsi:schemaLocation=&quot;urn:jboss:jbossws-jaxws-config:4.0 schema/jbossws-jaxws-config_4_0.xsd&quot;&gt;
&lt;endpoint-config&gt;
&lt;config-name&gt;jaspiSecurityDomain&lt;/config-name&gt;
&lt;property&gt;
&lt;property-name&gt;jaspi.security.domain&lt;/property-name&gt;
&lt;property-value&gt;jaspi&lt;/property-value&gt;
&lt;/property&gt;
&lt;/endpoint-config&gt;
&lt;/jaxws-config&gt;</pre>
        </div>
    </div>
    <div class="confbox admonition admonition-note">
        
    <p>
If the JASPI security domain is specified in both <tt class=" ">jboss-webservices.xml</tt> and config file referenced by <tt class=" ">@EndpointConfig</tt> annotation, the JASPI security domain specified in <tt class=" ">jboss-webservices.xml</tt> will take precedence.&nbsp;    </p>
    </div>
    
    </div>
    
        </div>
              <ul class="docnav">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <li class="previous"><a accesskey="p" href="Predefined_client_and_endpoint_configurations.html"><strong>Prev</strong>Predefined client and endpoint configurations</a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <li class="up"><a accesskey="u" href="#"><strong>Top of page</strong></a></li>
          <li class="home"><a accesskey="h" href="Documentation.html"><strong>Front page</strong></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <li class="next"><a accesskey="n" href="Apache_CXF_integration.html"><strong>Next</strong>Apache CXF integration</a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </ul>
          </div>
    <script type="text/javascript">
      SyntaxHighlighter.all()
    </script>
</body>
</html>

<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Messaging configuration - WildFly 9</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8" />
    <meta content="Scroll Wiki Publisher" name="generator"/>

    <link type="text/css" rel="stylesheet" href="css/blueprint/liquid.css" media="screen, projection"/>
    <link type="text/css" rel="stylesheet" href="css/blueprint/print.css" media="print"/>
    <!--[if lt IE 8]><link rel="stylesheet" href="css/blueprint/ie.css" type="text/css" media="screen, projection"/><![endif]-->

    <link type="text/css" rel="stylesheet" href="css/content-style.css" media="screen, projection, print"/>
    <link type="text/css" rel="stylesheet" href="css/screen.css" media="screen, projection"/>
    <link type="text/css" rel="stylesheet" href="css/print.css" media="print"/>
    
    <link type="text/css" rel="stylesheet" href="css/jbossorg.css"/>
    <link type="text/css" rel="stylesheet" href="css/docnav.css"/>    
    
    <link type="text/css" rel="stylesheet" href="sh/shCore.css"/>
    <link type="text/css" rel="stylesheet" href="sh/shCoreDefault.css"/>
    <script type="text/javascript" src="sh/shCore.js"></script>
    <script type="text/javascript" src="sh/shBrushAppleScript.js"></script>
    <script type="text/javascript" src="sh/shBrushAS3.js"></script>
    <script type="text/javascript" src="sh/shBrushBash.js"></script>
    <script type="text/javascript" src="sh/shBrushCpp.js"></script>
    <script type="text/javascript" src="sh/shBrushCSharp.js"></script>
    <script type="text/javascript" src="sh/shBrushCss.js"></script>
    <script type="text/javascript" src="sh/shBrushDiff.js"></script>
    <script type="text/javascript" src="sh/shBrushErlang.js"></script>
    <script type="text/javascript" src="sh/shBrushGroovy.js"></script>
    <script type="text/javascript" src="sh/shBrushJava.js"></script>
    <script type="text/javascript" src="sh/shBrushJavaFX.js"></script>
    <script type="text/javascript" src="sh/shBrushJScript.js"></script>
    <script type="text/javascript" src="sh/shBrushPerl.js"></script>
    <script type="text/javascript" src="sh/shBrushPhp.js"></script>
    <script type="text/javascript" src="sh/shBrushPlain.js"></script>
    <script type="text/javascript" src="sh/shBrushPython.js"></script>
    <script type="text/javascript" src="sh/shBrushRuby.js"></script>
    <script type="text/javascript" src="sh/shBrushScala.js"></script>
    <script type="text/javascript" src="sh/shBrushSql.js"></script>
    <script type="text/javascript" src="sh/shBrushVb.js"></script>
    <script type="text/javascript" src="sh/shBrushXml.js"></script>
    
</head>
<body>
    <div class="container" style="min-width: 760px;">
        <div class="block header">
          <p id="title">
            <a class="site_href" href="http://www.jboss.org"><strong>JBoss.org</strong></a>
            <a class="doc_href" href="http://docs.jboss.org"><strong>Community Documentation</strong></a>
          </p>
                  <ul class="docnav">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <li class="previous"><a accesskey="p" href="Loggers.html"><strong>Prev</strong></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <li class="next"><a accesskey="n" href="Naming_Subsystem_Configuration.html"><strong>Next</strong></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </ul>
                    <div>
            <h1>Messaging configuration</h1>
          </div>          
          </div>

        <div class="block content">
    <p>
The JMS server configuration is done through the <i class=" ">messaging</i> subsystem. In this chapter we are going outline the frequently used configuration options. For a more detailed explanation please consult the HornetQ user guide (See &quot;Component Reference&quot;).&nbsp;    </p>
    <div class="section-2"  id="80873130_Messagingconfiguration-Connectors"  >
        <h2>Connectors</h2>
    
    <p>
There are three kind of connectors that can be used to connect to WildFly JMS Server    </p>
<ul class=" "><li class=" ">    <p>
<tt class=" ">invm-connector</tt> can be used by a local client (i.e. one running in the same JVM as the server)    </p>
</li><li class=" ">    <p>
<tt class=" ">netty-connector</tt> can be used by a remote client (and uses Netty over TCP for the communication)    </p>
</li><li class=" ">    <p>
<tt class=" ">http-connector</tt> can be used by a remote client (and uses Undertow Web Server to upgrade from a HTTP connection)    </p>
</li></ul>    </div>
    
    <div class="section-2"  id="80873130_Messagingconfiguration-JMSConnectionFactories"  >
        <h2>JMS Connection Factories</h2>
    
    <p>
There are three kinds of <i class=" ">basic</i> JMS <tt class=" ">connection-factory</tt> that depends on the type of connectors that is used.    </p>
    <p>
There is also a <tt class=" ">pooled-connection-factory</tt>&nbsp;which is special in that it is essentially a configuration facade for <i class=" ">both</i>&nbsp;the inbound and outbound connectors of the&nbsp;the&nbsp;HornetQ JCA Resource Adapter. &nbsp;An MDB can be configured to use a <tt class=" ">pooled-connection-factory</tt> (e.g. using <tt class=" ">@ResourceAdapter</tt>). &nbsp;In this context, the MDB leverages the <i class=" ">inbound connector</i>&nbsp;of the HornetQ JCA RA. &nbsp;Other kinds of clients can look up the pooled-connection-factory in JNDI (or inject it) and use it to send messages. &nbsp;In this context, such a client would leverage the <i class=" ">outbound connector</i>&nbsp;of the HornetQ JCA RA. &nbsp;A <tt class=" ">pooled-connection-factory</tt>&nbsp;is also special because:    </p>
<ul class=" "><li class=" ">    <p>
It is only available to local clients, although it can be configured to point to a remote server.    </p>
</li><li class=" ">    <p>
As the name suggests, it is pooled and therefore provides superior performance to the clients which are able to use it. &nbsp;The pool size can be configured via the <tt class=" ">max-pool-size</tt> and <tt class=" ">min-pool-size</tt> attributes.    </p>
</li><li class=" ">    <p>
It should only be used to&nbsp;<i class=" ">send</i>&nbsp;(i.e. produce) messages when looked up in JNDI or injected.    </p>
</li><li class=" ">    <p>
It can be configured to use specific security credentials via the <tt class=" ">user</tt> and <tt class=" ">password</tt> attributes. &nbsp;This is useful if the remote server to which it is pointing is secured.    </p>
</li><li class=" ">    <p>
Resources acquired from it will be automatically enlisted any on-going JTA transaction. &nbsp;If you want to send a message from an EJB using CMT then this is likely the connection factory you want to use so the send operation will be atomically committed along with the rest of the EJB's transaction operations.    </p>
</li></ul>    <p>
To be clear, the <i class=" ">inbound connector</i>&nbsp;of the HornetQ JCA RA (which is for consuming messages) is only used by MDBs and other JCA-based components. &nbsp;It is not available to traditional clients.    </p>
    <p>
Both a&nbsp;<tt class=" ">connection-factory</tt>&nbsp;and a <tt class=" ">pooled-connection-factory</tt> reference a <tt class=" ">connector</tt> declaration. &nbsp;    </p>
    <p>
A <tt class=" ">netty-connector</tt> is&nbsp;associated with a <tt class=" ">socket-binding</tt>&nbsp;which tells the client using the <tt class=" ">connection-factory</tt> where to connect.    </p>
<ul class=" "><li class=" ">    <p>
A <tt class=" ">connection-factory</tt> referencing a <tt class=" ">netty-connector</tt> is suitable to be used by a&nbsp;<i class=" ">remote</i> client to send messages to or receive messages from the server (assuming the connection-factory has an appropriately exported <tt class=" ">entry</tt>). &nbsp;    </p>
</li><li class=" ">    <p>
A <tt class=" ">pooled-connection-factory</tt> looked up in JNDI or injected which is&nbsp;referencing a <tt class=" ">netty-connector</tt> is suitable to be used by a <i class=" ">local</i> client to send messages to a remote server granted the <tt class=" ">socket-binding</tt>&nbsp;references an <tt class=" ">outbound-socket-binding</tt> pointing to the remote server in question.    </p>
</li><li class=" ">    <p>
A&nbsp;<tt class=" ">pooled-connection-factory</tt>&nbsp;used by an MDB which is&nbsp;referencing a&nbsp;<tt class=" ">netty-connector</tt>&nbsp;is suitable to consume&nbsp;messages from a remote server granted the&nbsp;<tt class=" ">socket-binding</tt>&nbsp;references an&nbsp;<tt class=" ">outbound-socket-binding</tt>&nbsp;pointing to the remote server in question.    </p>
</li></ul>    <p>
An <tt class=" ">in-vm-connector</tt> is associated with a <tt class=" ">server-id</tt> which tells the client using the <tt class=" ">connection-factory</tt> where to connect (since multiple HornetQ servers can run in a single JVM).    </p>
<ul class=" "><li class=" ">    <p>
A&nbsp;<tt class=" ">connection-factory</tt> referencing an <tt class=" ">in-vm-connector</tt> is suitable to be used by a <i class=" ">local</i> client to either send messages to or receive messages from a local server. &nbsp;    </p>
</li><li class=" ">    <p>
A&nbsp;<tt class=" ">pooled-connection-factory</tt>&nbsp;looked up in JNDI or injected which is referencing an <tt class=" ">in-vm-connector</tt> is suitable to be used by a <i class=" ">local</i> client only to send messages to a local server.    </p>
</li><li class=" ">    <p>
A&nbsp;<tt class=" ">pooled-connection-factory</tt>&nbsp;used by an MDB which is referencing an&nbsp;<tt class=" ">in-vm-connector</tt>&nbsp;is suitable only to consume messages from a local server.    </p>
</li></ul>    <p>
A <tt class=" ">http-connector</tt> is associated with the <tt class=" ">socket-binding</tt> that represents the HTTP socket (by default, named <tt class=" ">http</tt>).    </p>
<ul class=" "><li class=" ">    <p>
A <tt class=" ">connection-factory</tt> referencing a <tt class=" ">http-connector</tt> is suitable to be used by a remote client to send messages to or receive messages from the server by connecting to its HTTP port before upgrading to the messaging protocol.    </p>
</li><li class=" ">    <p>
A <tt class=" ">pooled-connection-factory</tt> referencing a <tt class=" ">http-connector</tt> is suitable to be used by a local client to send messages&nbsp;to a remote server &nbsp;granted the&nbsp;<tt class=" ">socket-binding</tt>&nbsp;references an&nbsp;<tt class=" ">outbound-socket-binding</tt>&nbsp;pointing to the remote server in question.    </p>
</li><li class=" ">    <p>
A&nbsp;<tt class=" ">pooled-connection-factory</tt>&nbsp;used by an MDB which is referencing a&nbsp;<tt class=" ">http-connector</tt>&nbsp;is suitable&nbsp;only to consume messages from&nbsp;a remote server&nbsp;granted the&nbsp;<tt class=" ">socket-binding</tt>&nbsp;references an&nbsp;<tt class=" ">outbound-socket-binding</tt>&nbsp;pointing to the remote server in question.    </p>
</li></ul>    <p>
The <tt class=" ">entry</tt> declaration of a <tt class=" ">connection-factory</tt> or a <tt class=" ">pooled-connection-factory</tt> specifies the JNDI name under which the factory will be exposed. &nbsp;Only JNDI names bound in the <tt class=" ">&quot;java:jboss/exported&quot;</tt> namespace are available to remote clients. &nbsp;If a <tt class=" ">connection-factory</tt> has an entry bound in the&nbsp;<tt class=" ">&quot;java:jboss/exported&quot;</tt> namespace a remote client would look-up the <tt class=" ">connection-factory</tt> using the text <i class=" ">after</i>&nbsp;<tt class=" ">&quot;java:jboss/exported&quot;</tt>. &nbsp;For example, the &quot;<tt class=" ">RemoteConnectionFactory</tt>&quot; is bound by default to&nbsp;<tt class=" ">&quot;java:jboss/exported/jms/RemoteConnectionFactory&quot;</tt> which means a remote client would look-up this <tt class=" ">connection-factory</tt> using &quot;<tt class=" ">jms/RemoteConnectionFactory</tt>&quot;. &nbsp;A <tt class=" ">pooled-connection-factory</tt> should <i class=" ">not</i> have any <tt class=" ">entry</tt> bound in the&nbsp;&quot;<tt class=" ">java:jboss/exported</tt>&quot; namespace because a <tt class=" ">pooled-connection-factory</tt> is not suitable for remote clients.    </p>
    <p>
Since JMS 2.0, a default JMS connection factory is accessible to EE application&nbsp;under the JNDI name <tt class=" ">java:comp/DefaultJMSConnectionFactory.</tt> WildFly messaging subsystem defines a&nbsp;<tt class=" ">pooled-connection-factory</tt> that is used to provide this default connection factory. Any parameter change on this <tt class=" ">pooled-connection-factory</tt> will be take into account by any EE application looking the default JMS provider&nbsp;under the JNDI name&nbsp;<tt class=" ">java:comp/DefaultJMSConnectionFactory.</tt>    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">&lt;subsystem xmlns=&quot;urn:jboss:domain:messaging:2.0&quot;&gt;
   &lt;hornetq-server&gt;
      [...]
&nbsp; &nbsp; &nbsp; &lt;connectors&gt;
         &lt;http-connector name=&quot;http-connector&quot; socket-binding=&quot;http&quot;&gt;
            &lt;param key=&quot;http-upgrade-endpoint&quot; value=&quot;http-acceptor&quot;/&gt;
         &lt;/http-connector&gt;
         &lt;http-connector name=&quot;http-connector-throughput&quot; socket-binding=&quot;http&quot;&gt;
            &lt;param key=&quot;http-upgrade-endpoint&quot; value=&quot;http-acceptor-throughput&quot;/&gt;
            &lt;param key=&quot;batch-delay&quot; value=&quot;50&quot;/&gt;
         &lt;/http-connector&gt;
         &lt;in-vm-connector name=&quot;in-vm&quot; server-id=&quot;0&quot;/&gt;
      &lt;/connectors&gt;
      [...]
      &lt;jms-connection-factories&gt;
         &lt;connection-factory name=&quot;InVmConnectionFactory&quot;&gt;
            &lt;connectors&gt;
               &lt;connector-ref connector-name=&quot;in-vm&quot;/&gt;
            &lt;/connectors&gt;
            &lt;entries&gt;
               &lt;entry name=&quot;java:/ConnectionFactory&quot;/&gt;&nbsp;
            &lt;/entries&gt;
         &lt;/connection-factory&gt;&nbsp;
         &lt;connection-factory name=&quot;RemoteConnectionFactory&quot;&gt;
            &lt;connectors&gt;
               &lt;connector-ref connector-name=&quot;http-connector&quot;/&gt;
            &lt;/connectors&gt;
            &lt;entries&gt;
               &lt;entry name=&quot;java:jboss/exported/jms/RemoteConnectionFactory&quot;/&gt;
            &lt;/entries&gt;
         &lt;/connection-factory&gt;
         &lt;pooled-connection-factory name=&quot;hornetq-ra&quot;&gt;
            &lt;transaction mode=&quot;xa&quot;/&gt;
            &lt;connectors&gt;
               &lt;connector-ref connector-name=&quot;in-vm&quot;/&gt;
            &lt;/connectors&gt;
            &lt;entries&gt;
               &lt;entry name=&quot;java:/JmsXA&quot;/&gt;
               &lt;!-- Global JNDI entry used to provide a default JMS Connection factory to EE application --&gt;
               &lt;entry name=&quot;java:jboss/DefaultJMSConnectionFactory&quot;/&gt;
            &lt;/entries&gt;
         &lt;/pooled-connection-factory&gt;
      &lt;/jms-connection-factories&gt;
      [...]
   &lt;/hornetq-server&gt;
&lt;/subsystem&gt;</pre>
        </div>
    </div>
    <p>
<sub class=" ">(See standalone/configuration/standalone-full.xml)</sub>    </p>
    </div>
    
    <div class="section-2"  id="80873130_Messagingconfiguration-JMSQueuesandTopics"  >
        <h2>JMS Queues and Topics</h2>
    
    <p>
JMS queues and topics are sub resources of the messaging subsystem. &nbsp;They are defined in the <tt class=" ">jms-destinations</tt> section. &nbsp;One can define either a <tt class=" ">jms-queue</tt> or <tt class=" ">jms-topic</tt>. &nbsp;Each destination <i class=" ">must</i> be given a <tt class=" ">name</tt> and contain at least one <tt class=" ">entry</tt> element.    </p>
    <p>
Each <tt class=" ">entry</tt> refers to a JNDI name of the queue or topic. &nbsp;Keep in mind that any <tt class=" ">jms-queue</tt>&nbsp;or&nbsp;<tt class=" ">jms-topic</tt>&nbsp;which needs to be accessed by a remote client needs to have an <tt class=" ">entry</tt> in the &quot;java:jboss/exported&quot; namespace. &nbsp;As with connection factories, if a&nbsp;<tt class=" ">jms-queue</tt>&nbsp;or&nbsp;<tt class=" ">jms-topic</tt>&nbsp;has an <tt class=" ">entry</tt> bound in the&nbsp;&quot;java:jboss/exported&quot; namespace a remote client would look it up using the text&nbsp;<i class=" ">after</i>&nbsp;&quot;java:jboss/exported&quot;. &nbsp;For example, the following&nbsp;<tt class=" ">jms-queue</tt> &quot;testQueue&quot; is bound to&nbsp;&quot;java:jboss/exported/jms/queue/test&quot; which means a remote client would look-up this&nbsp;<tt class=" ">jms-queue</tt>&nbsp;using &quot;jms/queue/test&quot;. &nbsp;A local client could look it up using &quot;java:jboss/exported/jms/queue/test&quot;, &quot;java:jms/queue/test&quot;, or more simply &quot;jms/queue/test&quot;:    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">&lt;subsystem xmlns=&quot;urn:jboss:domain:messaging:2.0&quot;&gt;
   &lt;hornetq-server&gt;
      [...]
      &lt;jms-destinations&gt;
         &lt;jms-queue name=&quot;testQueue&quot;&gt;
             &lt;entry name=&quot;jms/queue/test&quot;/&gt;
             &lt;entry name=&quot;java:jboss/exported/jms/queue/test&quot;/&gt;
         &lt;/jms-queue&gt;
         &lt;jms-topic name=&quot;testTopic&quot;&gt;
            &lt;entry name=&quot;jms/topic/test&quot;/&gt;
            &lt;entry name=&quot;java:jboss/exported/jms/topic/test&quot;/&gt;
         &lt;/jms-topic&gt;
      &lt;/jms-destinations&gt;
   &lt;/hornetq-server&gt;
&lt;/subsystem&gt;</pre>
        </div>
    </div>
    <p>
<sub class=" ">(See standalone/configuration/standalone-full.xml)</sub>    </p>
    <p>
JMS endpoints can easily be created through the CLI:    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">[standalone@localhost:9990 /] jms-queue add --queue-address=myQueue --entries=queues/myQueue</pre>
        </div>
    </div>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">[standalone@localhost:9990 /] /subsystem=messaging/hornetq-server=default/jms-queue=myQueue:read-resource
{
    &quot;outcome&quot; =&gt; &quot;success&quot;,
    &quot;result&quot; =&gt; {
        &quot;durable&quot; =&gt; true,
        &quot;entries&quot; =&gt; [&quot;queues/myQueue&quot;],
        &quot;selector&quot; =&gt; undefined
    }
}</pre>
        </div>
    </div>
    <p>
A number of additional commands to maintain the JMS subsystem are available as well:    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">[standalone@localhost:9990 /] jms-queue --help --commands
add
...
remove
To read the description of a specific command execute 'jms-queue command_name --help'.</pre>
        </div>
    </div>
    </div>
    
    <div class="section-2"  id="80873130_Messagingconfiguration-DeadLetter%26Redelivery"  >
        <h2>Dead Letter &amp; Redelivery</h2>
    
    <p>
Some of the settings are applied against an address wild card instead of a specific messaging destination. The dead letter queue and redelivery settings belong into this group:    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">&lt;subsystem xmlns=&quot;urn:jboss:domain:messaging:2.0&quot;&gt;
   &lt;hornetq-server&gt;
      [...]
      &lt;address-settings&gt;
         &lt;address-setting match=&quot;#&quot;&gt;
            &lt;dead-letter-address&gt;jms.queue.DLQ&lt;/dead-letter-address&gt;
            &lt;expiry-address&gt;jms.queue.ExpiryQueue&lt;/expiry-address&gt;
            &lt;redelivery-delay&gt;0&lt;/redelivery-delay&gt;
            [...]
         &lt;/address-setting&gt;
      &lt;/address-settings&gt;
      [...]
   &lt;/hornetq-server&gt;
&lt;/subsystem&gt;</pre>
        </div>
    </div>
    <p>
<sub class=" ">(See standalone/configuration/standalone-full.xml)</sub>    </p>
    </div>
    
    <div class="section-2"  id="80873130_Messagingconfiguration-SecuritySettingsforHornetQaddressesandJMSdestinations"  >
        <h2>Security Settings for HornetQ addresses and JMS destinations</h2>
    
    <p>
Security constraints are matched against an address wildcard, similar to the DLQ and redelivery settings. &nbsp;<strong class=" ">Note</strong>: Multiple roles are separated by spaces.    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">&lt;subsystem xmlns=&quot;urn:jboss:domain:messaging:2.0&quot;&gt;
   &lt;hornetq-server&gt;
      [...]
      &lt;security-settings&gt;
         &lt;security-setting match=&quot;#&quot;&gt;
            &lt;permission type=&quot;send&quot; roles=&quot;guest&quot;/&gt;
            &lt;permission type=&quot;consume&quot; roles=&quot;guest&quot;/&gt;
            &lt;permission type=&quot;createNonDurableQueue&quot; roles=&quot;role1&quot;/&gt;
            &lt;permission type=&quot;deleteNonDurableQueue&quot; roles=&quot;role1 role2&quot;/&gt;
         &lt;/security-setting&gt;
      &lt;/security-settings&gt;
      [...]
   &lt;/hornetq-server&gt;
&lt;/subsystem&gt;</pre>
        </div>
    </div>
    <p>
<sub class=" ">(See standalone/configuration/standalone-full.xml)</sub>    </p>
    </div>
    
    <div class="section-2"  id="80873130_Messagingconfiguration-SecurityDomainforUsers"  >
        <h2>Security Domain for Users</h2>
    
    <p>
By default, HornetQ will use the &quot;<tt class=" ">other</tt>&quot; JAAS security domain. &nbsp;This domain is used to authenticate users making connections to HornetQ and then they are authorized to perform specific functions based on their role(s) and the <tt class=" ">security-settings</tt> described above. &nbsp;This domain can be changed by using&nbsp;<tt class=" ">security-domain</tt>, e.g.:    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">&lt;subsystem xmlns=&quot;urn:jboss:domain:messaging:2.0&quot;&gt;
   &lt;hornetq-server&gt;
      [...]
      &lt;security-domain&gt;mySecurityDomain&lt;/security-domain&gt;
      [...]
   &lt;/hornetq-server&gt;
&lt;/subsystem&gt;</pre>
        </div>
    </div>
    </div>
    
    <div class="section-2"  id="80873130_Messagingconfiguration-ClusterAuthentication"  >
        <h2>Cluster Authentication</h2>
    
    <p>
    <span style="color: #333333;">
If the HornetQ server is configured to be clustered (    </span>
    <span style="color: #333333;">
<tt class=" ">&lt;clustered&gt;true&lt;/clustered&gt;</tt>    </span>
    <span style="color: #333333;">
), it will use the    </span>
     <span style="color: #333333;">
<tt class=" ">&lt;cluster-user&gt;</tt>    </span>
     <span style="color: #333333;">
and    </span>
     <span style="color: #333333;">
<tt class=" ">&lt;cluster-password&gt;</tt>    </span>
     <span style="color: #333333;">
attributes to connect to other HornetQ nodes in the cluster.    </span>
    </p>
    <p>
If you do not change the default value of &lt;cluster-password&gt;, HornetQ will fail to authenticate with the error:    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">HQ224018: Failed to create session: HornetQExceptionerrorType=CLUSTER_SECURITY_EXCEPTION message=HQ119099: Unable to authenticate cluster user: HORNETQ.CLUSTER.ADMIN.USER</pre>
        </div>
    </div>
    <p>
To prevent this error, you must specify a value for&nbsp;<tt class=" ">&lt;cluster-password&gt;</tt>.&nbsp;It is possible to encrypt this value&nbsp;by following <a href="https://access.redhat.com/site/documentation/en-US/JBoss_Enterprise_Application_Platform/6.1/html/Security_Guide/sect-Password_Vaults_for_Sensitive_Strings.html">this guide</a>.    </p>
    <p>
Alternatively,&nbsp;you&nbsp;can use the system property&nbsp;jboss.messaging.cluster.password to specify the cluster password from the command line.    </p>
    </div>
    
    <div class="section-2"  id="80873130_Messagingconfiguration-Deploymentof%5Cjms.xmlfiles"  >
        <h2>Deployment of -jms.xml files</h2>
    
    <p>
Starting with WildFly 8,&nbsp;you have the ability to deploy a -jms.xml file defining JMS destinations, e.g.:    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;messaging-deployment xmlns=&quot;urn:jboss:messaging-deployment:1.0&quot;&gt;
   &lt;hornetq-server&gt;
      &lt;jms-destinations&gt;
         &lt;jms-queue name=&quot;sample&quot;&gt;
            &lt;entry name=&quot;jms/queue/sample&quot;/&gt;
            &lt;entry name=&quot;java:jboss/exported/jms/queue/sample&quot;/&gt;
         &lt;/jms-queue&gt;
      &lt;/jms-destinations&gt;
   &lt;/hornetq-server&gt;
&lt;/messaging-deployment&gt;</pre>
        </div>
    </div>
    <div class="tablewrap">
        <table>
<thead class=" "></thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td rowspan="1" colspan="1">
        <p>
    <img src="images/author/images/icons/emoticons/warning.gif" alt="images/author/images/icons/emoticons/warning.gif" />
        </p>
            </td>
                <td rowspan="1" colspan="1">
        <p>
This feature&nbsp;<strong class=" ">is&nbsp;primarily intended for development</strong>&nbsp;as destinations deployed this way can not be managed with any of the provided management tools (e.g. console, CLI, etc).    </p>
            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    
    <div class="section-2"  id="80873130_Messagingconfiguration-JMSBridge"  >
        <h2>JMS Bridge</h2>
    
    <p>
The function of a JMS bridge is to consume messages from a source JMS destination, and send them to a target JMS destination. Typically either the source or the target destinations are on different servers.<br/>The bridge can also be used to bridge messages from other non HornetQ JMS servers, as long as they are JMS 1.1 compliant.    </p>
    <p>
The JMS Bridge is provided by the HornetQ project. For a detailed description of the available configuration properties, please consult the project documentation.    </p>
    <div class="section-3"  id="80873130_Messagingconfiguration-Modulesforothermessagingbrokers"  >
        <h3>Modules for other messaging brokers</h3>
    
    <p>
Source and target JMS resources (destination and connection factories) are looked up using JNDI.<br/>If either the source or the target resources are managed by another messaging server than WildFly, the required client classes must be bundled in a module. The name of the module must then be declared when the JMS Bridge is configured.    </p>
    <p>
The use of a JMS bridges with any messaging provider will require to create a module containing the jar of this provider.    </p>
    <p>
Let's suppose we want to use an hypothetical messaging provider named AcmeMQ. We want to bridge messages coming from a source AcmeMQ destination to a target destination on the local WildFly messaging server.&nbsp;To lookup AcmeMQ resources from JNDI, 2 jars are required, acmemq-1.2.3.jar, mylogapi-0.0.1.jar (please note these jars do not exist, this is just for the example purpose). We must <i class=" ">not</i> include a JMS jar since it will be provided by a WildFly module directly.    </p>
    <p>
To use these resources in a JMS bridge, we must bundle them in a WildFly&nbsp;module:    </p>
    <p>
in JBOSS_HOME/modules, we create the layout:    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">modules/
`-- org
    `-- acmemq
        `-- main
            |-- acmemq-1.2.3.jar
            |-- mylogapi-0.0.1.jar
            `-- module.xml</pre>
        </div>
    </div>
    <p>
We define the module in <tt class=" ">module.xml</tt>:    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;module xmlns=&quot;urn:jboss:module:1.1&quot; name=&quot;org.acmemq&quot;&gt;
    &lt;properties&gt;
        &lt;property name=&quot;jboss.api&quot; value=&quot;private&quot;/&gt;
    &lt;/properties&gt;


    &lt;resources&gt;
        &lt;!-- insert resources required to connect to the source or target   --&gt;
        &lt;!-- messaging brokers if it not another WildFly instance           --&gt;
        &lt;resource-root path=&quot;acmemq-1.2.3.jar&quot; /&gt;
        &lt;resource-root path=&quot;mylogapi-0.0.1.jar&quot; /&gt;
    &lt;/resources&gt;


    &lt;dependencies&gt;
       &lt;!-- add the dependencies required by JMS Bridge code                --&gt;
       &lt;module name=&quot;javax.api&quot; /&gt;
       &lt;module name=&quot;javax.jms.api&quot; /&gt;
       &lt;module name=&quot;javax.transaction.api&quot;/&gt;
       &lt;module name=&quot;org.jboss.remote-naming&quot;/&gt;
       &lt;!-- we depend on org.hornetq module since we will send messages to  --&gt;
       &lt;!-- the HornetQ server embedded in the local WildFly instance       --&gt;
       &lt;module name=&quot;org.hornetq&quot; /&gt;
    &lt;/dependencies&gt;
&lt;/module&gt;</pre>
        </div>
    </div>
    </div>
    
    <div class="section-3"  id="80873130_Messagingconfiguration-Configuration"  >
        <h3>Configuration</h3>
    
    <p>
A JMS bridge is defined inside a <tt class=" ">jms-bridge</tt> section of the `messaging` subsystem in the XML configuration files.    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">&lt;subsystem xmlns=&quot;urn:jboss:domain:messaging:2.0&quot;&gt;
   &lt;jms-bridge name=&quot;myBridge&quot; module=&quot;org.acmemq&quot;&gt;
      &lt;source&gt;
         &lt;connection-factory name=&quot;ConnectionFactory&quot;/&gt;
         &lt;destination name=&quot;sourceQ&quot;/&gt;
         &lt;user&gt;user1&lt;/user&gt;
         &lt;password&gt;pwd1&lt;/password&gt;
         &lt;context&gt;
            &lt;property key=&quot;java.naming.factory.initial&quot; value=&quot;org.acmemq.jndi.AcmeMQInitialContextFactory&quot;/&gt;
            &lt;property key=&quot;java.naming.provider.url&quot;    value=&quot;tcp://127.0.0.1:9292&quot;/&gt;
         &lt;/context&gt;
      &lt;/source&gt;
      &lt;target&gt;
         &lt;connection-factory name=&quot;/jms/invmTargetCF&quot;/&gt;
         &lt;destination name=&quot;/jms/targetQ&quot;/&gt;
      &lt;/target&gt;
      &lt;quality-of-service&gt;AT_MOST_ONCE&lt;/quality-of-service&gt;
      &lt;failure-retry-interval&gt;500&lt;/failure-retry-interval&gt;
      &lt;max-retries&gt;1&lt;/max-retries&gt;
      &lt;max-batch-size&gt;500&lt;/max-batch-size&gt;
      &lt;max-batch-time&gt;500&lt;/max-batch-time&gt;
      &lt;add-messageID-in-header&gt;true&lt;/add-messageID-in-header&gt;
   &lt;/jms-bridge&gt;
&lt;/subsystem&gt;</pre>
        </div>
    </div>
    <p>
The <tt class=" ">source</tt> and <tt class=" ">target</tt> sections contain the name of the JMS resource (<tt class=" ">connection-factory</tt> and <tt class=" ">destination</tt>) that will be looked up in JNDI.<br/>It optionally defines the <tt class=" ">user</tt> and <tt class=" ">password</tt> credentials. If they are set, they will be passed as arguments when creating the JMS connection from the looked up ConnectionFactory.<br/>It is also possible to define JNDI context properties in the <tt class=" ">context</tt> section. If the <tt class=" ">context</tt> section is absent, the JMS resources will be looked up in the local WildFly instance (as it is the case in the <tt class=" ">target</tt> section in the example above).    </p>
    </div>
    
    <div class="section-3"  id="80873130_Messagingconfiguration-Managementcommands"  >
        <h3>Management commands</h3>
    
    <p>
A JMS Bridge can also be managed using the WildFly&nbsp;command line interface:    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">[standalone@localhost:9990 /] /subsystem=messaging/jms-bridge=myBridge/:add(module=&quot;org.acmemq&quot;,      \
      source-destination=&quot;sourceQ&quot;,                                                                   \
      source-connection-factory=&quot;ConnectionFactory&quot;,                                                  \
      source-user=&quot;user1&quot;,                                                                            \
      source-password=&quot;pwd1&quot;,                                                                         \
      source-context={&quot;java.naming.factory.initial&quot; =&gt; &quot;org.acmemq.jndi.AcmeMQInitialContextFactory&quot;, \
                      &quot;java.naming.provider.url&quot; =&gt; &quot;tcp://127.0.0.1:9292&quot;},                          \
      target-destination=&quot;/jms/targetQ&quot;,                                                              \
      target-connection-factory=&quot;/jms/invmTargetCF&quot;,                                                  \
      quality-of-service=AT_MOST_ONCE,                                                                \
      failure-retry-interval=500,                                                                     \
      max-retries=1,                                                                                  \
      max-batch-size=500,                                                                             \
      max-batch-time=500,                                                                             \
      add-messageID-in-header=true)
{&quot;outcome&quot; =&gt; &quot;success&quot;}</pre>
        </div>
    </div>
    <p>
You can also see the complete JMS Bridge resource description from the CLI:    </p>
    <div class="confbox programlisting">
                <div class="content">
        <pre class="brush: java; gutter: false;">[standalone@localhost:9990 /] /subsystem=messaging/jms-bridge=*/:read-resource-description
{
    &quot;outcome&quot; =&gt; &quot;success&quot;,
    &quot;result&quot; =&gt; [{
        &quot;address&quot; =&gt; [
            (&quot;subsystem&quot; =&gt; &quot;messaging&quot;),
            (&quot;jms-bridge&quot; =&gt; &quot;*&quot;)
        ],
        &quot;outcome&quot; =&gt; &quot;success&quot;,
        &quot;result&quot; =&gt; {
            &quot;description&quot; =&gt; &quot;A JMS bridge instance.&quot;,
            &quot;attributes&quot; =&gt; {
                ...
        }
    }]
}</pre>
        </div>
    </div>
    </div>
    
    </div>
    
    <div class="section-2"  id="80873130_Messagingconfiguration-ComponentReference"  >
        <h2>Component Reference</h2>
    
    <p>
The messaging subsystem is provided by the HornetQ project. For a detailed description of the available configuration properties, please consult the project documentation.    </p>
    <div class="confbox panel">
    <ul class=" "><li class=" ">    <p>
HornetQ homepage:&nbsp;<a href="http://www.jboss.org/hornetq">http://www.jboss.org/hornetq</a>    </p>
</li><li class=" ">    <p>
Project Documentation: &nbsp;<a href="http://www.jboss.org/hornetq/docs">http://www.jboss.org/hornetq/docs</a>    </p>
</li></ul>    </div>
    </div>
    
        </div>
              <ul class="docnav">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <li class="previous"><a accesskey="p" href="Loggers.html"><strong>Prev</strong>Loggers</a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <li class="up"><a accesskey="u" href="#"><strong>Top of page</strong></a></li>
          <li class="home"><a accesskey="h" href="Documentation.html"><strong>Front page</strong></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <li class="next"><a accesskey="n" href="Naming_Subsystem_Configuration.html"><strong>Next</strong>Naming Subsystem Configuration</a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </ul>
          </div>
    <script type="text/javascript">
      SyntaxHighlighter.all()
    </script>
</body>
</html>
